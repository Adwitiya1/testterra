import "tfplan" as plan
import "strings"

# Get all S3 buckets

allS3Buckets = plan.find_resources("aws_s3_bucket")

S3BucketsPublicACLsEnabled = plan.filter_attribute_is_not_value(allS3Buckets,"block_public_acls", true, true)

# Main rule

validated = length(S3BucketsPublicACLsEnabled["messages"]) is 0

main = rule {

validated is true

}

