import "tfplan-functions" as plan

# Get all S3 buckets

allS3Buckets = plan.find_resources("aws_s3_bucket_public_access_block")

S3BucketsPublicACLsEnabled = plan.filter_attribute_is_not_value(allS3Buckets,"block_public_acls", true, true)

# Main rule

validated = length(S3BucketsPublicACLsEnabled["messages"]) is 0

main = rule {

validated is true

}

